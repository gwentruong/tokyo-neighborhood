(this["webpackJsonptokyo-neighborhood"]=this["webpackJsonptokyo-neighborhood"]||[]).push([[0],{255:function(e,t,n){},258:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n(0),i=n(30),c=n.n(i),o=n(11),s=n(87),l=n(10),d=n.n(l),u=n(96),b=n(17),j=n(94),h=n.n(j),f=n(95),O=n.n(f),p=function(e){var t=e.data;return Object(a.jsx)("table",{children:Object(a.jsxs)("tbody",{children:[Object(a.jsxs)("tr",{children:[Object(a.jsx)("th",{children:"Number of unique buildings"}),Object(a.jsx)("td",{children:t.totalBuildings})]}),Object(a.jsxs)("tr",{children:[Object(a.jsx)("th",{children:"Average building area"}),Object(a.jsxs)("td",{children:[t.avgBuildingArea," m",Object(a.jsx)("sup",{children:"2"})]})]}),Object(a.jsxs)("tr",{children:[Object(a.jsx)("th",{children:"Total buildings area"}),Object(a.jsxs)("td",{children:[t.sumBuildingArea," m",Object(a.jsx)("sup",{children:"2"})]})]}),Object(a.jsxs)("tr",{children:[Object(a.jsx)("th",{children:"Landuse Area"}),Object(a.jsxs)("td",{children:[t.landuseArea," m",Object(a.jsx)("sup",{children:"2"})]})]}),Object(a.jsxs)("tr",{children:[Object(a.jsx)("th",{children:"Building : Landuse Ratio"}),Object(a.jsx)("td",{children:t.fractionArea})]})]})})},g=(n(255),n(256),n(257),{top:"0",bottom:"0",right:"0",left:"0",position:"absolute"}),x=["#54478c","#2c699a","#048ba8","#0db39e","#16db93","#83e377","#b9e769","#efea5a","#f1c453","#f29e4c"],m=function(){var e=Object(r.useState)(null),t=Object(o.a)(e,2),n=t[0],i=t[1],l=Object(r.useRef)(null),j=Object(r.useState)(null),f=Object(o.a)(j,2),m=f[0],v=f[1],y=Object(r.useState)(null),w=Object(o.a)(y,2),A=w[0],C=w[1],k=Object(r.useState)({}),B=Object(o.a)(k,2),M=B[0],N=B[1],S=Object(r.useState)([]),E=Object(o.a)(S,2),I=E[0],J=E[1],L=Object(r.useState)({}),R=Object(o.a)(L,2),z=R[0],D=R[1],F=Object(r.useRef)();d.a.accessToken="pk.eyJ1IjoidXllbnRydW9uZyIsImEiOiJjanVjcGN0b3IwaG5xNDNwZHJ3czRlNmJhIn0.u7o0VUuXY5f-rs4hcrwihA";var T=function(e,t){var n="[out:json];("+("building"===e?"way":"node")+"["+e+"]("+[t[1],t[0],t[3],t[2]].join(",")+"););out tags geom;";h.a.get("https://lz4.overpass-api.de/api/interpreter?data="+n).then((function(e){C(O()(e.data))}),(function(e){console.log("Error")}))};return Object(r.useEffect)((function(){!n&&function(e){var t=e.setMap,n=e.mapContainer,r=new d.a.Map({container:n.current,style:"mapbox://styles/mapbox/streets-v11",center:[139.757714,35.682746],maxBounds:[[139.730135,35.66863],[139.782844,35.705231]],zoom:15}),i=new d.a.ScaleControl({maxWidth:80,unit:"metric"});r.addControl(i,"bottom-right"),r.addControl(new d.a.FullscreenControl,"bottom-right");var o=new d.a.NavigationControl;r.addControl(o,"bottom-right");var s=new u.a({displayControlsDefault:!1,controls:{polygon:!0,trash:!0}});r.addControl(s,"top-right"),r.on("load",(function(){t(r),r.resize(),r.addSource("buildings",{type:"geojson",data:{type:"FeatureCollection",features:[]},generateId:!0}),r.addLayer({id:"buildings-fill",type:"fill",source:"buildings",paint:{"fill-color":"#b2c3ae","fill-outline-color":"#000","fill-opacity":.5}});var e=new d.a.Popup({closeOnMove:!0,closeOnClick:!0});r.on("draw.create",(function(e){var t=e.features[0],n=b.bbox(t);v(n),T("building",n),T("amenity",n)})),r.on("click","buildings-fill",(function(t){var n=t.features[0].properties,i=Object.keys(n),o=Object(a.jsx)("table",{children:Object(a.jsx)("tbody",{children:i.map((function(e,t){return Object(a.jsxs)("tr",{children:[Object(a.jsx)("th",{children:e}),Object(a.jsx)("td",{children:n[e]})]},t)}))})}),s=document.createElement("div","popup");c.a.render(o,s),e.setLngLat(t.lngLat).setDOMContent(s).addTo(r)}))}))}({setMap:i,mapContainer:l})}),[n]),Object(r.useEffect)((function(){I&&function(e){var t=Object.keys(e),n=t.map((function(t){return e[t]})),a=x.slice(0,t.length);D({labels:t,datasets:[{label:"Amenities",data:n,backgroundColor:a}]})}(I)}),[I]),Object(r.useEffect)((function(){A&&A.features&&function(){if(A)if(A.features[0].id.includes("way")){var e=Math.round(100*b.area(b.bboxPolygon(m)))/100,t=A.features.length,a=A.features.map((function(e){return b.area(e)})),r=Math.round(100*a.reduce((function(e,t){return e+t}),0))/100,i=Math.round(100*r/t)/100,c=Math.round(100*r/e)/100;n&&n.getSource("buildings").setData(A),N({totalBuildings:t,avgBuildingArea:i,sumBuildingArea:r,landuseArea:e,fractionArea:c})}else{var o=A.features,s=[],l={};o.forEach((function(e){var t=e.properties.amenity;s.includes(t)?l[t]+=1:(s.push(t),l[t]=1)})),J(l)}}()}),[A]),Object(a.jsxs)(r.Fragment,{children:[Object(a.jsx)("div",{ref:function(e){return l.current=e},style:g}),";",Object(a.jsx)("div",{className:"overlay",style:{margin:2,top:5,background:"#fff",height:"100%",position:"absolute"},children:Object(a.jsx)("div",{className:"overlay-col sidebar",style:{padding:"10px"},children:Object(a.jsxs)("div",{className:"overlay-content",style:{height:"100%",width:"100%"},children:[Object(a.jsx)("h2",{children:"Area overview"}),M?Object(a.jsx)(p,{data:M}):null,Object(a.jsx)("h2",{children:"Amenties"}),I?Object(a.jsx)("div",{styles:{width:"500px"},children:Object(a.jsx)(s.a,{ref:function(e){return F.current=e},data:z,width:200,height:400,options:{maintainAspectRatio:!1}})}):null]})})})]})};c.a.render(Object(a.jsx)(m,{}),document.getElementById("root"))}},[[258,1,2]]]);
//# sourceMappingURL=main.711675d6.chunk.js.map